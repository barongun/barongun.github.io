
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="sungik`s Blog">
    <title>아카이브: 2019/1 - sungik`s Blog</title>
    <meta name="author" content="Sung ik, Park">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="sungik`s Blog">
<meta property="og:url" content="https://barongun.github.io/archives/2019/01/index.html">
<meta property="og:site_name" content="sungik`s Blog">
<meta property="og:locale" content="ko">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sungik`s Blog">
    
    
        
    
    
        <meta property="og:image" content="https://barongun.github.io/assets/images/my-picture.jpeg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-c4ozcsklz4kht2pebhp44xorvyverh23toayhn7i6ubrpyedak24hv1v0hyd.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">sungik`s Blog</a>
    </div>
    
        
            <a class="header-right-picture " href="#about">
        
        
            <img class="header-picture" src="/assets/images/my-picture.jpeg" alt="저자 이미지">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/my-picture.jpeg" alt="저자 이미지">
                </a>
                <h4 class="sidebar-profile-name">Sung ik, Park</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/ " title="Home">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" title="카테고리">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" title="태그">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" title="아카이브">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link open-algolia-search" href="#search" title="검색">
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">검색</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://about.me/barongun" target="_blank" rel="noopener" title="About">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/barongun" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://facebook.com/barongun" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2019/01/09/spring-boot-using-altibase-database/">
                            Spring Boot 2.1.1에 Altibase 사용하기
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-01-09T00:42:47+09:00">
	
		    2019/01/09
    	
    </time>
    
        <span>카테고리 </span>
        
    <a class="category-link" href="/categories/SpringBoot/">SpringBoot</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>이번 회사 프로젝트를 <a href="http://support.altibase.com/kr/" target="_blank" rel="noopener">Altibase</a> 라는 디비를 써서 프로젝트를 진행한다.</p>
<p>회사에선 종종 쓰는 디비라 쓰는 데는 무리가 없을 줄 알았는데, 이번에 문제가 생겼다.</p>
<p>기존에 쓰던 환경은 오래된 스펙(Spring 3.x 버전)이었지만, 요새 환경엔 당연히 붙을거란 막연한 생각을 했던 것 같다.</p>
<p>결론부터 말하자면, 아래와 같다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. Spring Boot 의 HikariCP가 Altibase로는 연결이 되지 않는다.</span><br><span class="line">2. Altibase의 JDBC는 기본적으로 hibernate dialect 가 없다.</span><br></pre></td></tr></table></figure>
<h2 id="최초-Spring-Boot-설정"><a href="#최초-Spring-Boot-설정" class="headerlink" title="최초 Spring Boot 설정"></a>최초 Spring Boot 설정</h2><p>부트는 현재 가장 최신 버전은 <code>2.1.1</code> 버전을 사용했다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">compile(&quot;org.springframework.boot:spring-boot-starter-jdbc&quot;)</span><br><span class="line">implementation(&apos;org.springframework.boot:spring-boot-starter-data-jpa&apos;)</span><br><span class="line">implementation(&apos;org.springframework.boot:spring-boot-starter-web&apos;)</span><br><span class="line">compile fileTree(dir: &apos;libs&apos;, includes: [&apos;**/*.jar&apos;])</span><br></pre></td></tr></table></figure>
<p>Altibase JDBC는 maven에 관리하지 않아, 별도의 jar 파일(6.5 버전)을 받아 등록 시켰다.</p>
<p>간단한 JPA 예제를 만든 후 최초 구동 시 아래와 같은 에러가 출력 되었다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.jdbc.support.MetaDataAccessException:</span><br><span class="line">JDBC DatabaseMetaData method not implemented by JDBC driver - upgrade your driver;</span><br><span class="line">nested exception is java.lang.AbstractMethodError:</span><br><span class="line">Altibase6_5.jdbc.driver.AltibaseConnection.isValid(I)Z</span><br></pre></td></tr></table></figure>
<p>해당 에러를 다른 디비에서 찾아보면 드라이버가 오래되어 자바 버전을 지원 못한다는 이야기가 나오는 것 같다.</p>
<p>하지만 현재 쓰고 있는 드라이버는 Altibase 가장 최신 버전 아랫 버전이기도 하고, 심지어 가장 최신 버전의 드라이버도 써봤지만 마찬가지였다.</p>
<p>그래서 여러 사이트를 검색하다가 hikariCP 에서 최근 자바를 많이 참조하는 것 같아 다른 걸로 변경해 보기로 한다.</p>
<h2 id="tomcat-jdbc-사용하기"><a href="#tomcat-jdbc-사용하기" class="headerlink" title="tomcat-jdbc 사용하기"></a>tomcat-jdbc 사용하기</h2><p>hikariCP가 사용하는 최신 기능 때문에 Altibase가 구동이 안되는거면, 전통적인 jdbc인 tomcat-jdbc를 써보기로 한다.</p>
<p>아래의 dependency 를 추가한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile(&apos;org.apache.tomcat:tomcat-jdbc&apos;)</span><br></pre></td></tr></table></figure>
<p>이 모듈만 추가를 하고 구동을 하면 여전히 hikariCP로 구동이 된다.</p>
<p>따라서 Spring Boot properties에서 아래의 설정을 해준다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.type=org.apache.tomcat.jdbc.pool.DataSource</span><br></pre></td></tr></table></figure></p>
<p>설정 후 구동을 하면…짠! 하고 될 줄 알았는데…여전히 오류가 발생한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.beans.factory.BeanCreationException:</span><br><span class="line">Error creating bean with name &apos;entityManagerFactory&apos; defined in class path resource</span><br><span class="line">[org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]:</span><br><span class="line">Invocation of init method failed; nested exception is org.hibernate.service.spi.ServiceException:</span><br><span class="line">Unable to create requested service [org.hibernate.engine.jdbc.env.spi.JdbcEnvironment]</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Caused by: org.hibernate.HibernateException:</span><br><span class="line">Access to DialectResolutionInfo cannot be null when &apos;hibernate.dialect&apos; not set</span><br></pre></td></tr></table></figure>
<p>이런 에러가 나오지만, 실제 에러의 원인은 <code>hibernate.dialect</code> 에 있었다.</p>
<p>잘 알려진 디비를 사용하면 당연히 dialect 가 있겠지만, Altibase 는 그렇지 않았다.</p>
<p>hibernate에 기본으로 제공되는 디비가 아니라는 말이다.</p>
<p>Altibase가 국내에서 만든 디비라 그런지, 레퍼런스도 많지 않고…뭐 암튼 그렇다.</p>
<h2 id="hibernate-적용하기"><a href="#hibernate-적용하기" class="headerlink" title="hibernate 적용하기"></a>hibernate 적용하기</h2><p>다행히 <a href="https://github.com/ALTIBASE" target="_blank" rel="noopener">github</a> 계정은 존재한다.</p>
<p><a href="https://github.com/ALTIBASE/hibernate-orm" target="_blank" rel="noopener">hibernate-orm</a> 계정에 들어가보니 <a href="https://github.com/ALTIBASE/hibernate-orm/blob/master/ALTIBASE_DIALECT_PORTING.md" target="_blank" rel="noopener">How to port AltibaseDialect</a> 라는 문서가 있다.</p>
<p>해당 설명에는 기존 hibernate-core jar 파일에 AltibaseDialect.java 파일과 AltibaseLimitHandler.java 을 컴파일 해 다시 jar로 만들라고 안내하고 있지만,</p>
<p>구지 그럴 필욘 없다고 생각해 프로젝트에 그냥 넣기로 했다.<br><img src="/2019/01/09/spring-boot-using-altibase-database/1.png"></p>
<p>그런 후에 최종으로 설정을 하나 더 해주면 된다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.AltibaseDialect</span><br></pre></td></tr></table></figure></p>
<p>후에 구동을 하게 되면 아직 에러가 하나 더 출력이 되긴 하지만, 구동은 된다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java.lang.AbstractMethodError: Altibase6_5.jdbc.driver.AltibaseConnection.createClob()Ljava/sql/Clob;</span><br></pre></td></tr></table></figure>

                    
                        

                    
                    
                        <p>
                            <a href="/2019/01/09/spring-boot-using-altibase-database/#post-footer" class="postShorten-excerpt_link link">
                                댓글 공유
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 Sung ik, Park. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/my-picture.jpeg" alt="저자 이미지">
        
            <h4 id="about-card-name">Sung ik, Park</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
            <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-times"></i></span>
            <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <span class="searchby-algolia-text text-color-light text-small">by</span>
                <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search" class="form-control input--large search-input" placeholder="Search ">
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">포스트가 없습니다.</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://barongun.github.io/2018/12/30/start-blog/">
                            <h3 class="media-heading">블로그를 시작하며</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2018년 12월 30일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><h2 id="2019년이다"><a href="#2019년이다" class="headerlink" title="2019년이다."></a>2019년이다.</h2><p>항상 신년이 되면 생각해 보는 것이, <code>블로그를 해볼까?</code> 였고, 올 해도 역시나 그 생각을 해본다.<br></p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://barongun.github.io/2019/01/09/spring-boot-using-altibase-database/">
                            <h3 class="media-heading">Spring Boot 2.1.1에 Altibase 사용하기</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2019년 1월 9일
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium" data-message-zero="포스트가 없습니다." data-message-one="1 개의 포스트가 있습니다." data-message-other="{n} 개의 포스트가 있습니다.">
                2 개의 포스트가 있습니다.
            </p>
        </div>
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-dbd16rvloemmuxdzniplmnxxvwoz24eya9wol0b7vvmlokgqsjivmb8dnscy.min.js"></script>
<!--SCRIPTS END-->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment-with-locales.min.js"></script>
    <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
    <script>
        var algoliaClient = algoliasearch('HKFWQYY5U1', '1a9eea4fae4b5f8f83d863f339f74e3b');
        var algoliaIndex = algoliaClient.initIndex('psi-blog');
    </script>


    </body>
</html>
